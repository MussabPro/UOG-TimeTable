<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>UOG Timetable</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 20px;
        background-color: #f9f9f9;
      }
      .container {
        max-width: 1200px;
        margin: 0 auto;
        background-color: white;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      }
      h1 {
        text-align: center;
        color: #333;
        margin-bottom: 30px;
      }
      table {
        width: 100%;
        border-collapse: collapse;
        margin: 20px 0;
      }
      th,
      td {
        border: 1px solid #ddd;
        padding: 15px;
        text-align: center;
        vertical-align: middle;
      }
      th {
        background-color: #f5f5f5;
        color: #333;
        font-weight: bold;
      }
      .day-cell {
        background-color: #e9e9e9;
        font-weight: bold;
        width: 100px;
        color: #333;
      }
      .time-header {
        background-color: #f0f0f0;
        color: #333;
        min-width: 120px;
      }
      .course-info {
        background-color: white;
        min-height: 80px;
        padding: 10px;
      }
      .course-title {
        font-weight: bold;
        color: #333;
        margin-bottom: 5px;
        font-size: 14px;
      }
      .course-code {
        color: #666;
        font-size: 12px;
        margin-bottom: 5px;
      }
      .instructor {
        color: #333;
        font-size: 12px;
        margin-bottom: 5px;
      }
      .room {
        color: #666;
        font-size: 11px;
        font-weight: bold;
      }
      .empty-cell {
        background-color: #f8f8f8;
      }
      .input-section {
        margin-bottom: 30px;
        padding: 20px;
        background-color: #f9f9f9;
        border-radius: 8px;
      }
      .input-section textarea {
        width: 100%;
        height: 200px;
        padding: 10px;
        font-family: monospace;
        font-size: 12px;
        border: 1px solid #ddd;
        border-radius: 4px;
        resize: vertical;
      }
      .input-section button {
        margin-top: 10px;
        padding: 10px 20px;
        background-color: #333;
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-size: 14px;
      }
      .input-section button:hover {
        background-color: #555;
      }
      .input-section label {
        display: block;
        margin-bottom: 10px;
        font-weight: bold;
        color: #333;
      }
      .action-buttons {
        margin-top: 20px;
        text-align: center;
        display: none;
      }
      .action-buttons button {
        margin: 0 10px;
        padding: 12px 24px;
        background-color: #333;
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-size: 14px;
      }
      .action-buttons button:hover {
        background-color: #555;
      }
      @media print {
        body {
          margin: 0;
          padding: 0;
          background-color: white;
        }
        .container {
          max-width: none;
          margin: 0;
          padding: 10px;
          box-shadow: none;
        }
        .input-section,
        .action-buttons {
          display: none !important;
        }
        h1 {
          margin-bottom: 20px;
          font-size: 24px;
        }
        table {
          width: 100%;
          margin: 0;
          font-size: 12px;
        }
        th,
        td {
          padding: 8px;
          border: 1px solid #000;
        }
        .course-title {
          font-size: 11px;
        }
        .course-code,
        .instructor,
        .room {
          font-size: 10px;
        }
      }
      @page {
        size: landscape;
        margin: 0.5in;
      }
      .footer {
        margin-top: 40px;
        padding: 20px;
        text-align: center;
        background-color: #f9f9f9;
        border-radius: 8px;
        border-top: 2px solid #e0e0e0;
      }
      .footer h3 {
        margin-bottom: 15px;
        color: #333;
        font-size: 18px;
      }
      .contact-info {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 30px;
        flex-wrap: wrap;
      }
      .contact-item {
        display: flex;
        align-items: center;
        gap: 8px;
        color: #333;
        text-decoration: none;
        padding: 10px 15px;
        background-color: white;
        border-radius: 5px;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        transition: transform 0.2s;
      }
      .contact-item:hover {
        transform: translateY(-2px);
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
      }
      .contact-item .icon {
        font-size: 18px;
      }
      .contact-item .text {
        font-size: 14px;
        font-weight: 500;
      }
      @media print {
        .footer {
          display: none !important;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>UOG Timetable</h1>

      <div class="input-section">
        <label for="courseData"
          >Enter Course Data (Course Code, Section, Course Title, Cr. Hrs.,
          Instructor, Lecture Day, Lecture Time, Room):</label
        >
        <textarea
          id="courseData"
          placeholder="Paste your course data here...
LMS Format : Course Code	Section	Course Title	Cr. Hrs.	Instructor	Day	Time	Room
CMS Format: Course Code	Course Description	Course Section	Lecture Day	Lecture Time	Room Code

Example:
CS-255	EB	Computer Organization and Assembly Language	3	Muhammad Jabbar	MON	13:30-15:00	B205
CS-203	Data Structures	EB	Mon	18:00-19:30	B013B"
        ></textarea>
        <button onclick="generateTimetable()">Generate Timetable</button>
      </div>

      <table id="timetableTable" style="display: none"></table>

      <div class="action-buttons" id="actionButtons">
        <button onclick="printTimetable()">üñ®Ô∏è Print Timetable</button>
        <button onclick="downloadTimetable()">üì• Download PDF</button>
      </div>
    </div>

    <footer class="footer">
      <h3>Contact & Repository</h3>
      <div class="contact-info">
        <a href="mailto:mussabomair16@gmail.com" class="contact-item">
          <span class="icon">üìß</span>
          <span class="text">mussabomair16@gmail.com</span>
        </a>
        <a
          href="https://github.com/MussabPro/UOG-TimeTable"
          target="_blank"
          class="contact-item"
        >
          <span class="icon">üêô</span>
          <span class="text">GitHub Repository</span>
        </a>
      </div>
    </footer>

    <script>
      function generateTimetable() {
        const courseData = document.getElementById("courseData").value.trim();
        if (!courseData) {
          alert("Please enter course data");
          return;
        }

        const lines = courseData.split("\n").filter((line) => line.trim());
        const courses = [];

        lines.forEach((line, index) => {
          const parts = line.split("\t");
          console.log(`Line ${index}: `, parts); // Debug log

          // Skip header rows (lines that contain common header keywords)
          const headerKeywords = [
            "Course Code",
            "Course Description",
            "Course Section",
            "Section",
            "Lecture Day",
            "Lecture Time",
            "Room Code",
            "Room",
            "Instructor",
            "Cr. Hrs",
          ];
          const isHeaderRow = headerKeywords.some((keyword) =>
            parts.some(
              (part) =>
                part &&
                part.trim().toLowerCase().includes(keyword.toLowerCase())
            )
          );

          if (isHeaderRow) {
            console.log(`Skipping header row: `, parts); // Debug log
            return; // Skip this line
          }

          // Handle different data formats
          let courseData = {};

          // Check format based on content and length
          if (parts.length >= 8) {
            // Old format: Course Code, Section, Course Title, Cr. Hrs., Instructor, Lecture Day, Lecture Time, Room
            console.log("Using old format (8+ columns)");
            courseData = {
              code: parts[0] ? parts[0].trim() : "",
              section: parts[1] ? parts[1].trim() : "",
              title: parts[2] ? parts[2].trim() : "",
              credits: parts[3] ? parts[3].trim() : "",
              instructor: parts[4] || "",
              day: parts[5] ? parts[5].trim() : "",
              time: parts[6] ? parts[6].trim() : "",
              room: parts[7] || "",
            };
          } else if (parts.length === 6) {
            // New format: Course Code, Course Description, Course Section, Lecture Day, Lecture Time, Room Code
            console.log("Using new format (6 columns)");
            courseData = {
              code: parts[0] ? parts[0].trim() : "",
              title: parts[1] ? parts[1].trim() : "",
              section: parts[2] ? parts[2].trim() : "",
              day: parts[3] ? parts[3].trim() : "",
              time: parts[4] ? parts[4].trim() : "",
              room: parts[5] ? parts[5].trim() : "",
              credits: "", // Not provided in new format
              instructor: "", // Not provided in new format
            };
          }

          console.log("Parsed course data:", courseData); // Debug log

          // Only add courses that have required fields: code, title, section, day, and time
          if (
            courseData.code &&
            courseData.title &&
            courseData.section &&
            courseData.day &&
            courseData.time
          ) {
            console.log("Adding course:", courseData); // Debug log
            courses.push(courseData);
          } else {
            console.log(
              "Skipping course due to missing required fields:",
              courseData
            ); // Debug log
          }
        });

        // Create timetable structure
        const timetable = {
          MON: {},
          TUE: {},
          WED: {},
          THU: {},
          FRI: {},
        };

        const timeSlots = {
          "13:30-15:00": "1:30-3:00 PM",
          "15:00-16:30": "3:00-4:30 PM",
          "16:30-18:00": "4:30-6:00 PM",
          "18:00-19:30": "6:00-7:30 PM",
        };

        // Populate timetable
        courses.forEach((course) => {
          // Only process courses that have both day and time
          if (course.day.trim() !== "" && course.time.trim() !== "") {
            // Convert day format to uppercase and handle different formats
            let day = course.day.toUpperCase();
            if (day === "MONDAY") day = "MON";
            if (day === "TUESDAY") day = "TUE";
            if (day === "WEDNESDAY") day = "WED";
            if (day === "THURSDAY") day = "THU";
            if (day === "FRIDAY") day = "FRI";

            const time = course.time;
            if (timetable[day] && timeSlots[time]) {
              timetable[day][time] = course;
            }
          }
        }); // Generate table HTML
        let tableHTML = `
          <thead>
            <tr>
              <th>Day</th>
              <th class="time-header">1:30-3:00 PM</th>
              <th class="time-header">3:00-4:30 PM</th>
              <th class="time-header">4:30-6:00 PM</th>
              <th class="time-header">6:00-7:30 PM</th>
            </tr>
          </thead>
          <tbody>`;

        const days = ["MON", "TUE", "WED", "THU", "FRI"];
        const times = [
          "13:30-15:00",
          "15:00-16:30",
          "16:30-18:00",
          "18:00-19:30",
        ];

        days.forEach((day) => {
          tableHTML += `<tr><td class="day-cell">${day}</td>`;

          times.forEach((time) => {
            const course = timetable[day][time];
            if (course) {
              // Format room number with dash
              let room = course.room;
              if (room.match(/^B\d+[A-Z]?$/)) {
                room = room.replace(/^B(\d+)([A-Z]?)$/, "B-$1$2");
              }

              tableHTML += `
                <td class="course-info">
                  <div class="course-title">${course.title || ""}</div>
                  <div class="course-code">${course.code || ""}</div>
                  <div class="instructor">${course.instructor || ""}</div>
                  <div class="room">${room || ""}</div>
                </td>`;
            } else {
              tableHTML += `<td class="empty-cell"></td>`;
            }
          });

          tableHTML += "</tr>";
        });

        tableHTML += "</tbody>";
        document.getElementById("timetableTable").innerHTML = tableHTML;
        document.getElementById("timetableTable").style.display = "table";
        document.getElementById("actionButtons").style.display = "block";
      }

      function printTimetable() {
        window.print();
      }

      function downloadTimetable() {
        window.print();
      }

      // Initialize with empty textarea
      window.onload = function () {
        document.getElementById("courseData").value = "";
      };
    </script>
  </body>
</html>
